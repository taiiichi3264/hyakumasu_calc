<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>百ます計算 (掛け算) 用紙</title>
    <style>
      /* A4サイズに合わせた基本設定 */
      @page {
        size: A4;
        margin: 10mm; /* 印刷時の余白 */
      }
      body {
        font-family: "Arial", "sans-serif";
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
        margin: 0;
        padding: 10mm; /* 全体のパディング */
        box-sizing: border-box;
        line-height: 1.2; /* 行の高さを調整 */
        color: #333;
        background-color: #ffffff;
      }
      .container {
        width: 100%;
        max-width: 200mm; /* A4の印刷可能領域に合わせる */
        padding: 5mm;
        text-align: center;
        background-color: #ffffff;
        border-radius: 0;
        box-shadow: none;
      }
      h1 {
        font-size: 32pt;
        margin-top: 5px;
        margin-bottom: 15px;
        color: #333;
        text-shadow: none;
      }
      .instructions {
        font-size: 16pt;
        margin-bottom: 20px;
        color: #555;
        font-weight: normal;
      }
      .hyakumasu-grid-container {
        width: 100%;
        display: flex;
        justify-content: center;
        margin-bottom: 30px;
        overflow-x: auto; /* スマホなどで表示しきれない場合にスクロール可能に */
      }
      .hyakumasu-table {
        border-collapse: collapse; /* セルのボーダーを結合 */
        width: 100%;
        max-width: 180mm; /* A4幅に合わせて最大幅を設定 */
      }
      .hyakumasu-table th,
      .hyakumasu-table td {
        border: 1px solid #666; /* 濃い目のボーダー */
        width: 8%; /* 11列で約9%ずつ */
        padding: 4px 2px; /* パディングを調整 */
        text-align: center;
        font-size: 14pt; /* マス内のフォントサイズ */
        height: 18mm; /* マスの高さを均等に */
        box-sizing: border-box; /* パディングを考慮したサイズ計算 */
      }
      .hyakumasu-table th {
        background-color: #eee; /* ヘッダーの背景色 */
        font-weight: bold;
        color: #333;
        font-size: 16pt; /* ヘッダーのフォントサイズ */
      }
      /* 最初の 'x' セル */
      .hyakumasu-table thead th:first-child {
        background-color: #ddd;
      }

      /* 並び順選択ボタンのスタイル */
      .order-selection-group {
        margin-bottom: 15px;
        font-size: 16pt;
        color: #555;
      }
      .order-selection-group button {
        padding: 8px 15px;
        font-size: 14pt;
        border: 1px solid #ccc;
        border-radius: 5px;
        background-color: #f0f0f0;
        color: #333;
        cursor: pointer;
        margin: 0 5px;
        transition: background-color 0.2s ease;
      }
      .order-selection-group button.active {
        background-color: #007bff;
        color: white;
        border-color: #007bff;
      }
      .order-selection-group button:hover:not(.active) {
        background-color: #e0e0e0;
      }

      /* 印刷ボタン */
      .print-button {
        margin-top: 15px;
        padding: 10px 20px;
        font-size: 16pt;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: none;
        transition: none;
        text-shadow: none;
        font-weight: bold;
      }
      .print-button:hover {
        background-color: #0056b3;
      }

      /* 印刷時に非表示にする要素 */
      @media print {
        body {
          background: none;
          color: black;
          padding: 0;
        }
        .container {
          box-shadow: none;
          padding: 0;
        }
        .print-button,
        .order-selection-group {
          /* 印刷時にボタングループも非表示 */
          display: none;
        }
        .hyakumasu-table th,
        .hyakumasu-table td {
          border: 1px solid black; /* 印刷時は黒のボーダー */
          font-size: 14pt; /* 印刷時のフォントサイズを固定 */
          height: 18mm; /* 印刷時の高さも固定 */
        }
        h1,
        .instructions {
          color: black;
        }
        .hyakumasu-table th {
          background-color: #e0e0e0; /* 印刷時のヘッダー背景色 */
        }
        .hyakumasu-table thead th:first-child {
          background-color: #ccc;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>百ます計算 (掛け算)</h1>
      <p class="instructions">たてとよこの数字をかけて、マスをうめよう！</p>

      <!-- 並び順選択ボタン -->
      <div class="order-selection-group">
        <button id="sequentialOrderButton" class="active">順番</button>
        <button id="randomOrderButton">ランダム</button>
      </div>

      <div class="hyakumasu-grid-container">
        <table class="hyakumasu-table">
          <thead>
            <tr id="tableHeaderRow">
              <th>x</th>
              <!-- Numbers will be generated by JS -->
            </tr>
          </thead>
          <tbody id="tableBody">
            <!-- Rows will be generated by JS -->
          </tbody>
        </table>
      </div>
      <button class="print-button" onclick="window.print()">
        このプリントを印刷する
      </button>
    </div>

    <script>
      // Helper function to shuffle an array (Fisher-Yates algorithm)
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]]; // Swap elements
        }
      }

      document.addEventListener("DOMContentLoaded", function () {
        const tableHeaderRow = document.getElementById("tableHeaderRow");
        const tableBody = document.getElementById("tableBody");
        const sequentialOrderButton = document.getElementById(
          "sequentialOrderButton"
        );
        const randomOrderButton = document.getElementById("randomOrderButton");

        let currentOrderType = "sequential"; // 'sequential' or 'random'

        // Function to update active state of buttons
        function updateActiveButton(buttons, activeId) {
          buttons.forEach((btn) => {
            if (btn.id === activeId) {
              btn.classList.add("active");
            } else {
              btn.classList.remove("active");
            }
          });
        }

        // Function to generate and display the hundred square table
        function generateHyakumasuTable() {
          tableHeaderRow.innerHTML = "<th>x</th>"; // Reset header row
          tableBody.innerHTML = ""; // Clear table body

          let numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
          let columnNumbers = [...numbers]; // Numbers for the top row
          let rowNumbers = [...numbers]; // Numbers for the left column

          if (currentOrderType === "random") {
            shuffleArray(columnNumbers);
            shuffleArray(rowNumbers);
          }

          // Generate table header (top row numbers)
          columnNumbers.forEach((num) => {
            const th = document.createElement("th");
            th.textContent = num;
            tableHeaderRow.appendChild(th);
          });

          // Generate table body (rows and left column numbers)
          rowNumbers.forEach((num) => {
            const row = document.createElement("tr");
            const headerCell = document.createElement("th");
            headerCell.textContent = num;
            row.appendChild(headerCell);
            for (let j = 0; j < 10; j++) {
              // 10 empty data cells
              const dataCell = document.createElement("td");
              row.appendChild(dataCell);
            }
            tableBody.appendChild(row);
          });
        }

        // Event Listeners for order selection buttons
        sequentialOrderButton.addEventListener("click", () => {
          currentOrderType = "sequential";
          updateActiveButton(
            [sequentialOrderButton, randomOrderButton],
            "sequentialOrderButton"
          );
          generateHyakumasuTable();
        });

        randomOrderButton.addEventListener("click", () => {
          currentOrderType = "random";
          updateActiveButton(
            [sequentialOrderButton, randomOrderButton],
            "randomOrderButton"
          );
          generateHyakumasuTable();
        });

        // Initial table generation on page load
        generateHyakumasuTable();
        updateActiveButton(
          [sequentialOrderButton, randomOrderButton],
          "sequentialOrderButton"
        ); // Default active
      });
    </script>
  </body>
</html>
